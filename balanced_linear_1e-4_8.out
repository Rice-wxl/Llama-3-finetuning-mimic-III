## SLURM PROLOG ###############################################################
##    Job ID : 3644175
##  Job Name : finetune_llama3
##  Nodelist : gpu2110
##      CPUs : 
##  Mem/Node : 49152 MB
## Directory : /oscar/home/xwang259/Llama-3-finetuning-mimic-III
##   Job Started : Tue Jul 16 05:26:56 PM EDT 2024
###############################################################################
Unsloth 2024.7 patched 32 layers with 32 QKV layers, 32 O layers and 32 MLP layers.
🦥 Unsloth: Will patch your computer to enable 2x faster free finetuning.
The token has not been saved to the git credentials helper. Pass `add_to_git_credential=True` in this function directly or `--add-to-git-credential` if using via `huggingface-cli` if you want to set the git credential as well.
Token is valid (permission: read).
Your token has been saved to /users/xwang259/.cache/huggingface/token
Login successful
==((====))==  Unsloth: Fast Llama patching release 2024.7
   \\   /|    GPU: NVIDIA GeForce RTX 3090. Max memory: 23.691 GB. Platform = Linux.
O^O/ \_/ \    Pytorch: 2.1.0+cu121. CUDA = 8.6. CUDA Toolkit = 12.1.
\        /    Bfloat16 = TRUE. FA [Xformers = 0.0.22.post7. FA2 = False]
 "-____-"     Free Apache license: http://github.com/unslothai/unsloth
Number of rows that report yes: 5586
Number of rows that report no: 16814
Map (num_proc=4):   0%|          | 0/11172 [00:00<?, ? examples/s]Map (num_proc=4):   9%|▉         | 1000/11172 [00:23<03:58, 42.73 examples/s]Map (num_proc=4):  18%|█▊        | 2000/11172 [00:27<01:48, 84.69 examples/s]Map (num_proc=4):  27%|██▋       | 3000/11172 [00:27<00:54, 150.50 examples/s]Map (num_proc=4):  36%|███▌      | 4000/11172 [00:30<00:37, 189.91 examples/s]Map (num_proc=4):  36%|███▌      | 4000/11172 [00:43<00:37, 189.91 examples/s]Map (num_proc=4):  45%|████▍     | 5000/11172 [00:45<00:54, 113.66 examples/s]Map (num_proc=4):  54%|█████▎    | 6000/11172 [00:46<00:31, 165.40 examples/s]Map (num_proc=4):  63%|██████▎   | 7000/11172 [00:50<00:22, 188.82 examples/s]Map (num_proc=4):  72%|███████▏  | 8000/11172 [00:51<00:12, 247.87 examples/s]Map (num_proc=4):  79%|███████▊  | 8793/11172 [01:02<00:15, 153.37 examples/s]Map (num_proc=4):  86%|████████▌ | 9586/11172 [01:03<00:08, 189.51 examples/s]Map (num_proc=4):  93%|█████████▎| 10379/11172 [01:04<00:03, 245.34 examples/s]Map (num_proc=4): 100%|██████████| 11172/11172 [01:06<00:00, 277.51 examples/s]Map (num_proc=4): 100%|██████████| 11172/11172 [01:06<00:00, 167.58 examples/s]
==((====))==  Unsloth - 2x faster free finetuning | Num GPUs = 1
   \\   /|    Num examples = 11,172 | Num Epochs = 3
O^O/ \_/ \    Batch size per device = 2 | Gradient Accumulation steps = 4
\        /    Total batch size = 8 | Total steps = 4,188
 "-____-"     Number of trainable parameters = 41,943,040
wandb: Currently logged in as: xilin_wang1 (rice-factory). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.17.4
wandb: Run data is saved locally in /oscar/home/xwang259/Llama-3-finetuning-mimic-III/wandb/run-20240716_172939-rqw0pagn
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run balanced__1e-4_8
wandb: ⭐️ View project at https://wandb.ai/rice-factory/%3Cft_icdcodes_balanced%3E
wandb: 🚀 View run at https://wandb.ai/rice-factory/%3Cft_icdcodes_balanced%3E/runs/rqw0pagn
  0%|          | 0/4188 [00:00<?, ?it/s]  0%|          | 1/4188 [00:05<6:19:13,  5.43s/it]                                                    0%|          | 1/4188 [00:05<6:19:13,  5.43s/it]  0%|          | 2/4188 [00:09<5:18:01,  4.56s/it]                                                    0%|          | 2/4188 [00:09<5:18:01,  4.56s/it]  0%|          | 3/4188 [00:13<4:58:23,  4.28s/it]                                                    0%|          | 3/4188 [00:13<4:58:23,  4.28s/it]  0%|          | 4/4188 [00:17<4:49:18,  4.15s/it]                                                    0%|          | 4/4188 [00:17<4:49:18,  4.15s/it]  0%|          | 5/4188 [00:21<4:44:27,  4.08s/it]                                                    0%|          | 5/4188 [00:21<4:44:27,  4.08s/it]  0%|          | 6/4188 [00:25<4:41:50,  4.04s/it]                                                    0%|          | 6/4188 [00:25<4:41:50,  4.04s/it]  0%|          | 7/4188 [00:29<4:40:22,  4.02s/it]                                                    0%|          | 7/4188 [00:29<4:40:22,  4.02s/it]  0%|          | 8/4188 [00:33<4:39:28,  4.01s/it]                                                    0%|          | 8/4188 [00:33<4:39:28,  4.01s/it]  0%|          | 9/4188 [00:37<4:38:55,  4.00s/it]                                                    0%|          | 9/4188 [00:37<4:38:55,  4.00s/it]  0%|          | 10/4188 [00:41<4:38:36,  4.00s/it]                                                     0%|          | 10/4188 [00:41<4:38:36,  4.00s/it]  0%|          | 11/4188 [00:45<4:38:30,  4.00s/it]                                                     0%|          | 11/4188 [00:45<4:38:30,  4.00s/it]  0%|          | 12/4188 [00:49<4:38:29,  4.00s/it]                                                     0%|          | 12/4188 [00:49<4:38:29,  4.00s/it]  0%|          | 13/4188 [00:53<4:38:34,  4.00s/it]                                                     0%|          | 13/4188 [00:53<4:38:34,  4.00s/it]  0%|          | 14/4188 [00:57<4:38:48,  4.01s/it]                                                     0%|          | 14/4188 [00:57<4:38:48,  4.01s/it]  0%|          | 15/4188 [01:01<4:38:58,  4.01s/it]                                                     0%|          | 15/4188 [01:01<4:38:58,  4.01s/it]  0%|          | 16/4188 [01:05<4:39:07,  4.01s/it]                                                     0%|          | 16/4188 [01:05<4:39:07,  4.01s/it]  0%|          | 17/4188 [01:09<4:39:16,  4.02s/it]                                                     0%|          | 17/4188 [01:09<4:39:16,  4.02s/it]  0%|          | 18/4188 [01:13<4:39:18,  4.02s/it]                                                     0%|          | 18/4188 [01:13<4:39:18,  4.02s/it]  0%|          | 19/4188 [01:17<4:39:19,  4.02s/it]                                                     0%|          | 19/4188 [01:17<4:39:19,  4.02s/it]  0%|          | 20/4188 [01:21<4:39:19,  4.02s/it]                                                     0%|          | 20/4188 [01:21<4:39:19,  4.02s/it]  1%|          | 21/4188 [01:25<4:39:23,  4.02s/it]                                                     1%|          | 21/4188 [01:25<4:39:23,  4.02s/it]  1%|          | 22/4188 [01:29<4:39:40,  4.03s/it]                                                     1%|          | 22/4188 [01:29<4:39:40,  4.03s/it]  1%|          | 23/4188 [01:33<4:39:38,  4.03s/it]                                                     1%|          | 23/4188 [01:33<4:39:38,  4.03s/it]  1%|          | 24/4188 [01:37<4:39:35,  4.03s/it]                                                     1%|          | 24/4188 [01:37<4:39:35,  4.03s/it]  1%|          | 25/4188 [01:41<4:39:30,  4.03s/it]                                                     1%|          | 25/4188 [01:41<4:39:30,  4.03s/it]  1%|          | 26/4188 [01:45<4:39:28,  4.03s/it]                                                     1%|          | 26/4188 [01:45<4:39:28,  4.03s/it]  1%|          | 27/4188 [01:49<4:39:26,  4.03s/it]                                                     1%|          | 27/4188 [01:49<4:39:26,  4.03s/it]  1%|          | 28/4188 [01:53<4:39:26,  4.03s/it]                                                     1%|          | 28/4188 [01:53<4:39:26,  4.03s/it]  1%|          | 29/4188 [01:57<4:39:28,  4.03s/it]                                                     1%|          | 29/4188 [01:57<4:39:28,  4.03s/it]  1%|          | 30/4188 [02:01<4:39:20,  4.03s/it]                                                     1%|          | 30/4188 [02:01<4:39:20,  4.03s/it]  1%|          | 31/4188 [02:05<4:39:18,  4.03s/it]                                                     1%|          | 31/4188 [02:05<4:39:18,  4.03s/it]  1%|          | 32/4188 [02:09<4:39:13,  4.03s/it]                                                     1%|          | 32/4188 [02:09<4:39:13,  4.03s/it]  1%|          | 33/4188 [02:13<4:39:08,  4.03s/it]                                                     1%|          | 33/4188 [02:13<4:39:08,  4.03s/it]  1%|          | 34/4188 [02:17<4:39:09,  4.03s/it]                                                     1%|          | 34/4188 [02:17<4:39:09,  4.03s/it]  1%|          | 35/4188 [02:21<4:39:05,  4.03s/it]                                                     1%|          | 35/4188 [02:21<4:39:05,  4.03s/it]  1%|          | 36/4188 [02:25<4:39:09,  4.03s/it]                                                     1%|          | 36/4188 [02:25<4:39:09,  4.03s/it]  1%|          | 37/4188 [02:29<4:39:13,  4.04s/it]                                                     1%|          | 37/4188 [02:29<4:39:13,  4.04s/it]  1%|          | 38/4188 [02:33<4:39:00,  4.03s/it]                                                     1%|          | 38/4188 [02:33<4:39:00,  4.03s/it]  1%|          | 39/4188 [02:37<4:38:57,  4.03s/it]                                                     1%|          | 39/4188 [02:37<4:38:57,  4.03s/it]  1%|          | 40/4188 [02:41<4:38:53,  4.03s/it]                                                     1%|          | 40/4188 [02:41<4:38:53,  4.03s/it]  1%|          | 41/4188 [02:46<4:38:48,  4.03s/it]                                                     1%|          | 41/4188 [02:46<4:38:48,  4.03s/it]  1%|          | 42/4188 [02:50<4:38:44,  4.03s/it]                                                     1%|          | 42/4188 [02:50<4:38:44,  4.03s/it]  1%|          | 43/4188 [02:54<4:38:39,  4.03s/it]                                                     1%|          | 43/4188 [02:54<4:38:39,  4.03s/it]  1%|          | 44/4188 [02:58<4:38:34,  4.03s/it]                                                     1%|          | 44/4188 [02:58<4:38:34,  4.03s/it]  1%|          | 45/4188 [03:02<4:38:25,  4.03s/it]                                                     1%|          | 45/4188 [03:02<4:38:25,  4.03s/it]  1%|          | 46/4188 [03:06<4:38:23,  4.03s/it]                                                     1%|          | 46/4188 [03:06<4:38:23,  4.03s/it]  1%|          | 47/4188 [03:10<4:38:21,  4.03s/it]                                                     1%|          | 47/4188 [03:10<4:38:21,  4.03s/it]  1%|          | 48/4188 [03:14<4:38:20,  4.03s/it]                                                     1%|          | 48/4188 [03:14<4:38:20,  4.03s/it]  1%|          | 49/4188 [03:18<4:38:11,  4.03s/it]                                                     1%|          | 49/4188 [03:18<4:38:11,  4.03s/it]  1%|          | 50/4188 [03:22<4:38:05,  4.03s/it]                                                     1%|          | 50/4188 [03:22<4:38:05,  4.03s/it]  1%|          | 51/4188 [03:26<4:38:04,  4.03s/it]                                                     1%|          | 51/4188 [03:26<4:38:04,  4.03s/it]  1%|          | 52/4188 [03:30<4:38:03,  4.03s/it]                                                     1%|          | 52/4188 [03:30<4:38:03,  4.03s/it]  1%|▏         | 53/4188 [03:34<4:37:59,  4.03s/it]                                                     1%|▏         | 53/4188 [03:34<4:37:59,  4.03s/it]  1%|▏         | 54/4188 [03:38<4:37:57,  4.03s/it]                                                     1%|▏         | 54/4188 [03:38<4:37:57,  4.03s/it]  1%|▏         | 55/4188 [03:42<4:37:55,  4.03s/it]                                                     1%|▏         | 55/4188 [03:42<4:37:55,  4.03s/it]  1%|▏         | 56/4188 [03:46<4:37:52,  4.03s/it]                                                     1%|▏         | 56/4188 [03:46<4:37:52,  4.03s/it]  1%|▏         | 57/4188 [03:50<4:37:48,  4.04s/it]                                                     1%|▏         | 57/4188 [03:50<4:37:48,  4.04s/it]  1%|▏         | 58/4188 [03:54<4:37:44,  4.03s/it]                                                     1%|▏         | 58/4188 [03:54<4:37:44,  4.03s/it]  1%|▏         | 59/4188 [03:58<4:37:41,  4.04s/it]                                                     1%|▏         | 59/4188 [03:58<4:37:41,  4.04s/it]  1%|▏         | 60/4188 [04:02<4:37:34,  4.03s/it]                                                     1%|▏         | 60/4188 [04:02<4:37:34,  4.03s/it]  1%|▏         | 61/4188 [04:06<4:37:27,  4.03s/it]                                                     1%|▏         | 61/4188 [04:06<4:37:27,  4.03s/it]  1%|▏         | 62/4188 [04:10<4:37:24,  4.03s/it]                                                     1%|▏         | 62/4188 [04:10<4:37:24,  4.03s/it]  2%|▏         | 63/4188 [04:14<4:37:24,  4.03s/it]                                                     2%|▏         | 63/4188 [04:14<4:37:24,  4.03s/it]  2%|▏         | 64/4188 [04:18<4:37:23,  4.04s/it]                                                     2%|▏         | 64/4188 [04:18<4:37:23,  4.04s/it]  2%|▏         | 65/4188 [04:22<4:37:16,  4.04s/it]                                                     2%|▏         | 65/4188 [04:22<4:37:16,  4.04s/it]  2%|▏         | 66/4188 [04:26<4:37:09,  4.03s/it]                                                     2%|▏         | 66/4188 [04:26<4:37:09,  4.03s/it]  2%|▏         | 67/4188 [04:30<4:37:49,  4.04s/it]                                                     2%|▏         | 67/4188 [04:30<4:37:49,  4.04s/it]  2%|▏         | 68/4188 [04:34<4:37:40,  4.04s/it]                                                     2%|▏         | 68/4188 [04:34<4:37:40,  4.04s/it]  2%|▏         | 69/4188 [04:38<4:37:25,  4.04s/it]                                                     2%|▏         | 69/4188 [04:39<4:37:25,  4.04s/it]  2%|▏         | 70/4188 [04:43<4:37:14,  4.04s/it]                                                     2%|▏         | 70/4188 [04:43<4:37:14,  4.04s/it]  2%|▏         | 71/4188 [04:47<4:37:05,  4.04s/it]                                                     2%|▏         | 71/4188 [04:47<4:37:05,  4.04s/it]  2%|▏         | 72/4188 [04:51<4:36:59,  4.04s/it]                                                     2%|▏         | 72/4188 [04:51<4:36:59,  4.04s/it]  2%|▏         | 73/4188 [04:55<4:36:55,  4.04s/it]                                                     2%|▏         | 73/4188 [04:55<4:36:55,  4.04s/it]  2%|▏         | 74/4188 [04:59<4:36:50,  4.04s/it]                                                     2%|▏         | 74/4188 [04:59<4:36:50,  4.04s/it]  2%|▏         | 75/4188 [05:03<4:36:57,  4.04s/it]                                                     2%|▏         | 75/4188 [05:03<4:36:57,  4.04s/it]  2%|▏         | 76/4188 [05:07<4:36:47,  4.04s/it]                                                     2%|▏         | 76/4188 [05:07<4:36:47,  4.04s/it]  2%|▏         | 77/4188 [05:11<4:36:40,  4.04s/it]                                                     2%|▏         | 77/4188 [05:11<4:36:40,  4.04s/it]  2%|▏         | 78/4188 [05:15<4:36:32,  4.04s/it]                                                     2%|▏         | 78/4188 [05:15<4:36:32,  4.04s/it]  2%|▏         | 79/4188 [05:19<4:36:23,  4.04s/it]                                                     2%|▏         | 79/4188 [05:19<4:36:23,  4.04s/it]  2%|▏         | 80/4188 [05:23<4:36:21,  4.04s/it]                                                     2%|▏         | 80/4188 [05:23<4:36:21,  4.04s/it]  2%|▏         | 81/4188 [05:27<4:36:17,  4.04s/it]                                                     2%|▏         | 81/4188 [05:27<4:36:17,  4.04s/it]  2%|▏         | 82/4188 [05:31<4:36:16,  4.04s/it]                                                     2%|▏         | 82/4188 [05:31<4:36:16,  4.04s/it]  2%|▏         | 83/4188 [05:35<4:36:08,  4.04s/it]                                                     2%|▏         | 83/4188 [05:35<4:36:08,  4.04s/it]  2%|▏         | 84/4188 [05:39<4:36:02,  4.04s/it]                                                     2%|▏         | 84/4188 [05:39<4:36:02,  4.04s/it]  2%|▏         | 85/4188 [05:43<4:36:00,  4.04s/it]                                                     2%|▏         | 85/4188 [05:43<4:36:00,  4.04s/it]  2%|▏         | 86/4188 [05:47<4:35:55,  4.04s/it]                                                     2%|▏         | 86/4188 [05:47<4:35:55,  4.04s/it]  2%|▏         | 87/4188 [05:51<4:35:49,  4.04s/it]                                                     2%|▏         | 87/4188 [05:51<4:35:49,  4.04s/it]  2%|▏         | 88/4188 [05:55<4:35:41,  4.03s/it]                                                     2%|▏         | 88/4188 [05:55<4:35:41,  4.03s/it]  2%|▏         | 89/4188 [05:59<4:35:38,  4.03s/it]                                                     2%|▏         | 89/4188 [05:59<4:35:38,  4.03s/it]  2%|▏         | 90/4188 [06:03<4:35:34,  4.03s/it]                                                     2%|▏         | 90/4188 [06:03<4:35:34,  4.03s/it]  2%|▏         | 91/4188 [06:07<4:35:32,  4.04s/it]                                                     2%|▏         | 91/4188 [06:07<4:35:32,  4.04s/it]  2%|▏         | 92/4188 [06:11<4:35:27,  4.04s/it]                                                     2%|▏         | 92/4188 [06:11<4:35:27,  4.04s/it]  2%|▏         | 93/4188 [06:15<4:35:29,  4.04s/it]                                                     2%|▏         | 93/4188 [06:15<4:35:29,  4.04s/it]  2%|▏         | 94/4188 [06:19<4:35:23,  4.04s/it]                                                     2%|▏         | 94/4188 [06:19<4:35:23,  4.04s/it]  2%|▏         | 95/4188 [06:23<4:35:17,  4.04s/it]                                                     2%|▏         | 95/4188 [06:23<4:35:17,  4.04s/it]  2%|▏         | 96/4188 [06:27<4:35:17,  4.04s/it]                                                     2%|▏         | 96/4188 [06:27<4:35:17,  4.04s/it]  2%|▏         | 97/4188 [06:32<4:35:20,  4.04s/it]                                                     2%|▏         | 97/4188 [06:32<4:35:20,  4.04s/it]  2%|▏         | 98/4188 [06:36<4:36:04,  4.05s/it]                                                     2%|▏         | 98/4188 [06:36<4:36:04,  4.05s/it]  2%|▏         | 99/4188 [06:40<4:35:39,  4.04s/it]                                                     2%|▏         | 99/4188 [06:40<4:35:39,  4.04s/it]  2%|▏         | 100/4188 [06:44<4:35:23,  4.04s/it]                                                      2%|▏         | 100/4188 [06:44<4:35:23,  4.04s/it]  2%|▏         | 101/4188 [06:48<4:35:12,  4.04s/it]                                                      2%|▏         | 101/4188 [06:48<4:35:12,  4.04s/it]  2%|▏         | 102/4188 [06:52<4:35:00,  4.04s/it]                                                      2%|▏         | 102/4188 [06:52<4:35:00,  4.04s/it]  2%|▏         | 103/4188 [06:56<4:34:52,  4.04s/it]                                                      2%|▏         | 103/4188 [06:56<4:34:52,  4.04s/it]  2%|▏         | 104/4188 [07:00<4:35:02,  4.04s/it]                                                      2%|▏         | 104/4188 [07:00<4:35:02,  4.04s/it]  3%|▎         | 105/4188 [07:04<4:34:53,  4.04s/it]                                                      3%|▎         | 105/4188 [07:04<4:34:53,  4.04s/it]